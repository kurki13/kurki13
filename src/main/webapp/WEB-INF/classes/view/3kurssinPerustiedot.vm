#parse("hello.vm")

<h3>$bundle.getString("3coursebasics")</h3>

#if ($valittuKurssi.getTila() == "J")
    #set ($jaassa = true)
#else
    #set ($jaassa = false)
#end

#set($Integer = 0)

<input type=hidden>
##Laskareiden get-parametrit
    #set($lh = $params.get('lh'))
    #set($lh_p = $params.get('lh_p'))
    #set($lh_lp = $params.get('lh_lp'))
    #if($lh)
        $valittuKurssi.setHarjoitustunnit($Integer.parseInt($lh))
        Laskuharjoitusten määräksi asetettu $lh
    #end
    #if($lh_p)
        $valittuKurssi.setPakolliset_laskaritehtava_lkm($Integer.parseInt($lh_p))
        Laskuharjoitusten pakollisten laskareiden arvoksi asetettu $lh_p
    #end
    #if($lh_lp)
        $valittuKurssi.setMax_laskaripisteet($Integer.parseInt($lh_lp))
        Laskuharjoitusten maksimipisteiden arvoksi asetettu $lh_lp
    #end

##Harjoitustöiden get-parametrit
    #set($ht = $params.get('ht'))
    #set($ht_p = $params.get('ht_p'))
    #set($ht_lp = $params.get('ht_lp'))
    #if($ht)
        $valittuKurssi.setHarjoitustyo_lkm($Integer.parseInt($ht))
        Harjoitustöiden määräksi asetettu $ht
    #end
    #if($ht_p)
        $valittuKurssi.setPakolliset_harjoitustyo_lkm($Integer.parseInt($ht_p))
        Harjoitustöiden pakollisten töiden arvoksi asetettu $ht_p
    #end
    #if($ht_lp)
        $valittuKurssi.setHarjoitustyopisteet($Integer.parseInt($ht_lp))
        Harjoitustöiden maksimipisteiden arvoksi asetettu $ht_lp
    #end

##Kokeiden get-parametrit
    #set($koe = $params.get('koe'))
    #set($koe_p = $params.get('koe_p'))
    #if($koe)
        $valittuKurssi.setValikokeet_lkm($Integer.parseInt($koe))
        Kokeiden määräksi asetettu $koe
    #end
    #if($koe_p)
        $valittuKurssi.setPakolliset_koe_lkm($Integer.parseInt($koe_p))
        Pakollisten kokeiden määräksi asetettu $koe_p
    #end
</input>
##Tallennetaan kurssi kantaan
$KurssiKyselyt.tallennaKantaan($valittuKurssi)

##Tässä määritellään säädettäville kentille otsikot, niiden arvot tietokantaoliosta, ja get -parametrien arvo
#set($basics = {
    $bundle.getString("laskuharjoituksia") : [
            [""                               ,$valittuKurssi.harjoitustunnit, "lh"], 
            [$bundle.getString("jpakollisia") ,$valittuKurssi.pakolliset_laskaritehtava_lkm, "lh_p"], 
            [$bundle.getString("lisapisteet") ,$valittuKurssi.max_laskaripisteet, "lh_lp"]
        ],
    $bundle.getString("harjoitustoita") : [
            [""                                ,$valittuKurssi.harjoitustyo_lkm, "ht"], 
            [$bundle.getString("jpakollisia")  ,$valittuKurssi.pakolliset_harjoitustyo_lkm, "ht_p" ], 
            [$bundle.getString("lisapisteet")  ,$valittuKurssi.harjoitustyopisteet, "ht_lp"]
        ],
    $bundle.getString("kokeita") : [
            [ ""                               ,$valittuKurssi.valikokeet_lkm, "koe"], 
            [ $bundle.getString("jpakollisia") ,$valittuKurssi.pakolliset_koe_lkm, "koe_p"]
        ]
    }
)

<form name="kurssinPerustiedot" action="" method=get class="form-inline">
    #foreach($otsikko in $basics.keySet()) ##Otsikko tässä joko Laskuharjoitukset, Harjoitustyöt tai Kokeet
        ##<h3>$otsikko</h3>
        <br>
        <table>
        #foreach($alaotsikko in $basics.get($otsikko))
            #set($nimi = $alaotsikko.get(0))
            #set($kentta = $alaotsikko.get(1))
            #set($parametri = $alaotsikko.get(2))
            <tr>
                <td>
                    #if($nimi.equals(""))$otsikko#end
                    $nimi
                </td>
                <td>
                    <input type="text" 
                    class="form-control" 
                    style="width:50px"
                    name="$parametri" ##get-parametria varten, "lh", "lh_p" jne...
                    value="$kentta" ##arvo valitun kurssin oliolta
                    #if($jaassa) readonly #end>
                </td>
            </tr>
        #end
        </table>
    #end
    <br>    
    <input type=submit class="btn" value=$bundle.getString("tmuutokset") onClick="">
</form>
</body>
<html>